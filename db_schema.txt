-- Drop existing tables in reverse order of dependency to avoid foreign key constraints errors
DROP TABLE IF EXISTS "order_items" CASCADE;
DROP TABLE IF EXISTS "vmi_version_items" CASCADE;
DROP TABLE IF EXISTS "vmi_proposal_versions" CASCADE;
DROP TABLE IF EXISTS "notifications" CASCADE;
DROP TABLE IF EXISTS "mobile_nav_config" CASCADE;
DROP TABLE IF EXISTS "category_sort" CASCADE;
DROP TABLE IF EXISTS "application_settings" CASCADE;
DROP TABLE IF EXISTS "products" CASCADE;
DROP TABLE IF EXISTS "orders" CASCADE;
DROP TABLE IF EXISTS "vmi_orders" CASCADE;
DROP TABLE IF EXISTS "product_types" CASCADE;
DROP TABLE IF EXISTS "categories" CASCADE;
DROP TABLE IF EXISTS "alert_banners" CASCADE;
DROP TABLE IF EXISTS "dispensaries" CASCADE;
DROP TABLE IF EXISTS "user_business_units" CASCADE;
DROP TABLE IF EXISTS "users" CASCADE;
DROP TABLE IF EXISTS "roles" CASCADE;

-- =============================================
--                 Core Tables
-- =============================================

-- Roles table to manage user permissions
CREATE TABLE "roles" (
  "id" TEXT PRIMARY KEY,
  "name" TEXT NOT NULL UNIQUE,
  "permissions" JSONB NOT NULL
);

-- Users table
CREATE TABLE "users" (
  "id" TEXT PRIMARY KEY,
  "username" TEXT NOT NULL UNIQUE,
  "email" TEXT NOT NULL UNIQUE,
  "password" TEXT NOT NULL, -- Storing plain text for this demo based on seed data. Use password_hash in production.
  "profile_picture" TEXT,
  "role_id" TEXT NOT NULL REFERENCES "roles"("id")
);

-- Many-to-many relationship between users and their accessible business units
CREATE TABLE "user_business_units" (
  "user_id" TEXT NOT NULL REFERENCES "users"("id") ON DELETE CASCADE,
  "business_unit" TEXT NOT NULL,
  PRIMARY KEY ("user_id", "business_unit")
);


-- =============================================
--              Product Catalog
-- =============================================

-- Categories for products
CREATE TABLE "categories" (
  "id" TEXT PRIMARY KEY,
  "name" TEXT NOT NULL,
  "business_unit" TEXT NOT NULL
);

-- Product Types (e.g., Flower - 3.5g, Vape - 1g)
CREATE TABLE "product_types" (
  "id" SERIAL PRIMARY KEY,
  "name" TEXT NOT NULL,
  "price" NUMERIC(10, 2) NOT NULL,
  "image" TEXT,
  "category_id" TEXT NOT NULL REFERENCES "categories"("id"),
  "business_unit" TEXT NOT NULL
);

-- Alert Banners (e.g., New, Limited)
CREATE TABLE "alert_banners" (
  "id" TEXT PRIMARY KEY,
  "text" TEXT NOT NULL,
  "color" TEXT NOT NULL,
  "business_unit" TEXT NOT NULL
);

-- Products table
CREATE TABLE "products" (
  "id" TEXT PRIMARY KEY,
  "name" TEXT NOT NULL,
  "description" TEXT NOT NULL,
  "sku" TEXT NOT NULL UNIQUE,
  "top_terpenes" TEXT,
  "genetics" TEXT,
  "feels_like" TEXT,
  "doh_type" TEXT NOT NULL,
  "qty_in_stock" INTEGER NOT NULL DEFAULT 0,
  "business_unit" TEXT NOT NULL,
  "product_type_id" INTEGER REFERENCES "product_types"("id"),
  "category_id" TEXT NOT NULL REFERENCES "categories"("id"),
  "alert_banner_id" TEXT REFERENCES "alert_banners"("id")
);

-- =============================================
--            Dispensary & Ordering
-- =============================================

-- Sales Reps are just users with the 'Sales Rep' role.
-- We link dispensaries to a user ID.

-- Dispensaries table
CREATE TABLE "dispensaries" (
  "id" TEXT PRIMARY KEY,
  "name" TEXT NOT NULL,
  "address" TEXT NOT NULL,
  "phone" TEXT,
  "license_number" TEXT NOT NULL UNIQUE,
  "email" TEXT NOT NULL,
  "sales_rep_id" TEXT NOT NULL REFERENCES "users"("id")
);

-- Regular Orders table
CREATE TABLE "orders" (
  "id" TEXT PRIMARY KEY,
  "order_date" TIMESTAMPTZ NOT NULL,
  "dispensary_id" TEXT NOT NULL REFERENCES "dispensaries"("id"),
  "sales_rep_id" TEXT NOT NULL REFERENCES "users"("id"),
  "business_unit" TEXT NOT NULL
);

-- Line items for regular orders
CREATE TABLE "order_items" (
  "id" SERIAL PRIMARY KEY,
  "order_id" TEXT NOT NULL REFERENCES "orders"("id") ON DELETE CASCADE,
  "product_id" TEXT NOT NULL REFERENCES "products"("id"),
  "quantity" INTEGER NOT NULL,
  "price_at_time_of_order" NUMERIC(10, 2) NOT NULL,
  "product_snapshot" JSONB -- Store key product details for historical accuracy
);

-- =============================================
--             VMI Ordering System
-- =============================================

-- VMI Orders (Proposals) table
CREATE TABLE "vmi_orders" (
  "id" TEXT PRIMARY KEY,
  "dispensary_id" TEXT NOT NULL REFERENCES "dispensaries"("id"),
  "sales_rep_id" TEXT NOT NULL REFERENCES "users"("id"),
  "status" TEXT NOT NULL,
  "is_active" BOOLEAN NOT NULL DEFAULT true,
  "business_unit" TEXT NOT NULL
);

-- Versions of a VMI proposal
CREATE TABLE "vmi_proposal_versions" (
  "id" SERIAL PRIMARY KEY,
  "vmi_order_id" TEXT NOT NULL REFERENCES "vmi_orders"("id") ON DELETE CASCADE,
  "version_number" INTEGER NOT NULL,
  "created_by" TEXT NOT NULL,
  "created_at" TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  "changes" JSONB,
  UNIQUE ("vmi_order_id", "version_number")
);

-- Line items for each version of a VMI proposal
CREATE TABLE "vmi_version_items" (
  "id" SERIAL PRIMARY KEY,
  "version_id" INTEGER NOT NULL REFERENCES "vmi_proposal_versions"("id") ON DELETE CASCADE,
  "product_id" TEXT NOT NULL REFERENCES "products"("id"),
  "quantity" INTEGER NOT NULL,
  "price_at_time_of_proposal" NUMERIC(10, 2) NOT NULL,
  "product_snapshot" JSONB
);

-- =============================================
--             System & Configuration
-- =============================================

CREATE TABLE "mobile_nav_config" (
  "id" TEXT PRIMARY KEY,
  "label" TEXT NOT NULL,
  "icon" TEXT NOT NULL,
  "is_visible" BOOLEAN NOT NULL,
  "display_order" INTEGER NOT NULL
);

CREATE TABLE "notifications" (
  "id" TEXT PRIMARY KEY,
  "user_id" TEXT NOT NULL REFERENCES "users"("id") ON DELETE CASCADE,
  "type" TEXT NOT NULL,
  "business_unit" TEXT NOT NULL,
  "message" TEXT NOT NULL,
  "link" TEXT NOT NULL,
  "timestamp" TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  "is_read" BOOLEAN NOT NULL DEFAULT false
);

CREATE TABLE "application_settings" (
  "key" TEXT PRIMARY KEY,
  "value" TEXT NOT NULL
);

CREATE TABLE "category_sort" (
  "id" SERIAL PRIMARY KEY,
  "business_unit" TEXT NOT NULL,
  "category_name" TEXT NOT NULL,
  "sort_order" INTEGER NOT NULL,
  UNIQUE ("business_unit", "category_name")
);


-- =============================================
--                 SEED DATA
-- =============================================

-- Seed Roles
INSERT INTO "roles" ("id", "name", "permissions") VALUES
('role-super-admin', 'Super Admin', '{"products": {"view": true, "edit": true, "create": true, "delete": true}, "productTypes": {"view": true, "edit": true, "create": true, "delete": true}, "categorySort": {"view": true, "edit": true}, "alertBanners": {"view": true, "edit": true, "create": true, "delete": true}, "ordersRegular": {"view": true}, "ordersVmi": {"view": true, "edit": true, "delete": true}, "dispensaries": {"view": true, "edit": true, "create": true, "delete": true}, "users": {"view": true, "edit": true, "create": true, "delete": true}, "roles": {"view": true, "edit": true, "create": true, "delete": true}, "inventory": {"view": true, "edit": true}, "mobileNav": {"view": true, "edit": true}, "categories": {"view": true, "edit": true, "create": true, "delete": true}}'),
('role-admin', 'Admin', '{"products": {"view": true, "edit": true, "create": true, "delete": true}, "productTypes": {"view": true, "edit": true, "create": true, "delete": true}, "categorySort": {"view": true, "edit": true}, "alertBanners": {"view": true, "edit": true, "create": true, "delete": true}, "ordersRegular": {"view": true}, "ordersVmi": {"view": true, "edit": true, "delete": true}, "dispensaries": {"view": true, "edit": true, "create": true, "delete": true}, "users": {"view": true, "edit": true, "create": true, "delete": true}, "roles": {"view": true, "edit": true, "create": true, "delete": true}, "inventory": {"view": true, "edit": true}, "mobileNav": {"view": true, "edit": true}, "categories": {"view": true, "edit": true, "create": true, "delete": true}}'),
('role-sales', 'Sales Rep', '{"products": {"view": true, "edit": false, "create": false, "delete": false}, "productTypes": {"view": false, "edit": false, "create": false, "delete": false}, "categorySort": {"view": false, "edit": false}, "alertBanners": {"view": false, "edit": false, "create": false, "delete": false}, "ordersRegular": {"view": true}, "ordersVmi": {"view": true, "edit": true, "delete": false}, "dispensaries": {"view": true, "edit": false, "create": false, "delete": false}, "users": {"view": true, "edit": false, "create": false, "delete": false}, "roles": {"view": false, "edit": false, "create": false, "delete": false}, "inventory": {"view": true, "edit": false}, "mobileNav": {"view": false, "edit": false}, "categories": {"view": false, "edit": false, "create": false, "delete": false}}');

-- Seed Users
-- In production, 'password' should be a bcrypt hash.
INSERT INTO "users" ("id", "username", "email", "password", "profile_picture", "role_id") VALUES
('user-1', 'superadmin', 'jasonc@fairwindsmanufacturing.com', '1234', 'https://placehold.co/150x150/e2e8f0/475569?text=User', 'role-super-admin'),
('user-2', 'johndoe', 'johndoe@sunshine.com', 'password', 'https://placehold.co/150x150/e2e8f0/475569?text=User', 'role-sales'),
('user-3', 'admin', 'admin@sunshine.com', '1234', 'https://placehold.co/150x150/e2e8f0/475569?text=User', 'role-admin'),
('user-4', 'mariag', 'mariag@fwpf.com', 'password', 'https://placehold.co/150x150/e2e8f0/475569?text=User', 'role-sales');

-- Seed User Business Units
INSERT INTO "user_business_units" ("user_id", "business_unit") VALUES
('user-1', 'sunshine'),
('user-1', 'fairwinds'),
('user-1', 'passion-flower'),
('user-2', 'sunshine'),
('user-2', 'fairwinds'),
('user-2', 'passion-flower'),
('user-3', 'sunshine'),
('user-3', 'fairwinds'),
('user-3', 'passion-flower'),
('user-4', 'sunshine'),
('user-4', 'fairwinds'),
('user-4', 'passion-flower');

-- Seed Dispensaries
INSERT INTO "dispensaries" ("id", "name", "address", "phone", "license_number", "email", "sales_rep_id") VALUES
('disp-1', 'Sunshine Dispensary â€” Downtown', '123 Main St, Springfield, WA', '(555) 123-4567', '1234', 'downtown@sunshine.com', 'user-2'),
('disp-2', 'Green Leaf Wellness', '456 Oak Ave, Metropolis, WA', '(555) 987-6543', '426849', 'contact@greenleaf.com', 'user-2'),
('disp-3', 'The Herbalist', '789 Pine Ln, Gotham, WA', '(555) 222-3333', '654321', 'orders@theherbalist.com', 'user-4'),
('disp-4', 'Emerald City Cannabis', '101 Flower Rd, Central City, WA', '(555) 444-5555', '111222', 'manager@emeraldcannabis.com', 'user-4');

-- Seed Categories
INSERT INTO "categories" ("id", "name", "business_unit") VALUES
('cat-sun-1', 'Flower', 'sunshine'),
('cat-sun-2', 'Pre-Rolls', 'sunshine'),
('cat-sun-3', 'Vape', 'sunshine'),
('cat-sun-4', 'Edibles', 'sunshine'),
('cat-sun-5', 'Concentrates', 'sunshine'),
('cat-fw-1', 'Tinctures', 'fairwinds'),
('cat-fw-2', 'Capsules', 'fairwinds'),
('cat-fw-3', 'Topicals', 'fairwinds'),
('cat-fw-4', 'Vape', 'fairwinds'),
('cat-fw-5', 'Pets', 'fairwinds'),
('cat-pf-1', 'Flower', 'passion-flower'),
('cat-pf-2', 'Infused Pre-Rolls', 'passion-flower');

-- Seed Product Types
-- We need to get the category_id from the categories table.
-- Using subqueries for robustness.
INSERT INTO "product_types" ("name", "price", "image", "category_id", "business_unit") VALUES
('Flower - 3.5g', 25.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Flower' AND business_unit='sunshine'), 'sunshine'),
('Flower - 7g', 45.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Flower' AND business_unit='sunshine'), 'sunshine'),
('Vape - 1g', 35.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Vape' AND business_unit='sunshine'), 'sunshine'),
('Pre-Roll - 1.5g Infused', 15.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Pre-Rolls' AND business_unit='sunshine'), 'sunshine'),
('Edible - 100mg Gummies', 20.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Edibles' AND business_unit='sunshine'), 'sunshine'),
('Concentrate - 1g', 30.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Concentrates' AND business_unit='sunshine'), 'sunshine'),
('Vape Cartridge - 0.5g', 30.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Vape' AND business_unit='fairwinds'), 'fairwinds'),
('Tincture - 30ml', 55.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Tinctures' AND business_unit='fairwinds'), 'fairwinds'),
('Capsules - 10 pack', 40.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Capsules' AND business_unit='fairwinds'), 'fairwinds'),
('Flow Cream - 50ml', 60.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Topicals' AND business_unit='fairwinds'), 'fairwinds'),
('Companion Tincture', 45.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Pets' AND business_unit='fairwinds'), 'fairwinds'),
('PF Flower - 3.5g', 30.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Flower' AND business_unit='passion-flower'), 'passion-flower'),
('PF Infused Pre-Roll - 1g', 18.00, 'https://placehold.co/400x400/e2e8f0/475569?text=Product', (SELECT id FROM categories WHERE name='Infused Pre-Rolls' AND business_unit='passion-flower'), 'passion-flower');

-- Seed Alert Banners
INSERT INTO "alert_banners" ("id", "text", "color", "business_unit") VALUES
('new-sun', 'New', '#ef4444', 'sunshine'),
('limited-sun', 'Limited', '#3b82f6', 'sunshine'),
('new-fw', 'New Item!', '#10b981', 'fairwinds');

-- Seed Products
-- Using subqueries to get foreign keys
INSERT INTO "products" ("id", "name", "description", "sku", "top_terpenes", "genetics", "feels_like", "doh_type", "qty_in_stock", "business_unit", "product_type_id", "category_id", "alert_banner_id") VALUES
('prod-sun-1', 'Pineapple Express', 'Sweet, tropical, cedar. Energetic, happy, creative.', 'SUN-FL-PEX-35', 'Terpinolene, Myrcene', 'Sativa', 'Energetic, Happy', 'DOH-High THC', 50, 'sunshine', (SELECT id FROM product_types WHERE name='Flower - 3.5g'), (SELECT id FROM categories WHERE name='Flower' AND business_unit='sunshine'), 'new-sun'),
('prod-sun-2', 'GG4', 'Earthy, pungent, pine. Relaxed, happy, euphoric.', 'SUN-FL-GG4-70', 'Caryophyllene, Limonene', 'Indica', 'Relaxed, Euphoric', 'DOH-High THC', 45, 'sunshine', (SELECT id FROM product_types WHERE name='Flower - 7g'), (SELECT id FROM categories WHERE name='Flower' AND business_unit='sunshine'), NULL),
('prod-sun-3', 'Durban Poison Vape', 'Earthy, sweet, pine. Energetic, focused, creative.', 'SUN-VP-DBP-10', 'Terpinolene, Myrcene', 'Sativa', 'Energetic, Focused', 'DOH-High THC', 60, 'sunshine', (SELECT id FROM product_types WHERE name='Vape - 1g'), (SELECT id FROM categories WHERE name='Vape' AND business_unit='sunshine'), NULL),
('prod-sun-4', 'Glue Infused Pre-Roll', 'Earthy, pungent, pine. Relaxed, happy, euphoric.', 'SUN-PR-GLU-15', 'Caryophyllene, Myrcene', 'Hybrid', 'Relaxed, Happy', 'DOH-High THC', 30, 'sunshine', (SELECT id FROM product_types WHERE name='Pre-Roll - 1.5g Infused'), (SELECT id FROM categories WHERE name='Pre-Rolls' AND business_unit='sunshine'), 'limited-sun'),
('prod-fw-1', 'Lifestyle Cat2 Vape', 'The classic cannabis experience for those who like to keep it simple.', 'FW-VP-LS2-05', 'N/A', 'Hybrid', 'Balanced, Relaxed', 'DOH-High THC', 80, 'fairwinds', (SELECT id FROM product_types WHERE name='Vape Cartridge - 0.5g'), (SELECT id FROM categories WHERE name='Vape' AND business_unit='fairwinds'), 'new-fw'),
('prod-fw-2', 'Ratio Series 20:1 Tincture', 'Clear, calm, and collected. Powerful results with a clear head.', 'FW-TN-R20-30', 'N/A', 'CBD', 'Calm, Clear, Relaxed', 'DOH-High CBD', 40, 'fairwinds', (SELECT id FROM product_types WHERE name='Tincture - 30ml'), (SELECT id FROM categories WHERE name='Tinctures' AND business_unit='fairwinds'), NULL),
('prod-pf-1', 'Blueberry Flower', 'Sweet berries, earthy. Relaxed, happy, sleepy.', 'PF-FL-BBR-35', 'Myrcene, Caryophyllene', 'Indica', 'Relaxed, Sleepy', 'DOH-High THC', 65, 'passion-flower', (SELECT id FROM product_types WHERE name='PF Flower - 3.5g'), (SELECT id FROM categories WHERE name='Flower' AND business_unit='passion-flower'), NULL);


-- Seed a regular order
INSERT INTO "orders" ("id", "order_date", "dispensary_id", "sales_rep_id", "business_unit") VALUES
('ord-seed-1', NOW() - INTERVAL '1 day', 'disp-3', 'user-4', 'fairwinds');

INSERT INTO "order_items" ("order_id", "product_id", "quantity", "price_at_time_of_order", "product_snapshot") VALUES
('ord-seed-1', 'prod-fw-2', 5, 55.00, '{"name": "Ratio Series 20:1 Tincture", "sku": "FW-TN-R20-30"}');

-- Seed a notification for the order
INSERT INTO "notifications" ("id", "user_id", "type", "business_unit", "message", "link", "timestamp", "is_read") VALUES
('notif-1', 'user-4', 'order-regular', 'fairwinds', 'New order received from The Herbalist.', 'orders-received', NOW() - INTERVAL '1 day', false);


-- Seed a VMI Order
INSERT INTO "vmi_orders" ("id", "dispensary_id", "sales_rep_id", "status", "is_active", "business_unit") VALUES
('vmi-prop-1', 'disp-1', 'user-2', 'pending_review', true, 'sunshine-pf');

-- Seed VMI Versions
INSERT INTO "vmi_proposal_versions" ("vmi_order_id", "version_number", "created_by", "created_at", "changes") VALUES
('vmi-prop-1', 1, 'sales_rep', NOW() - INTERVAL '2 days', NULL),
('vmi-prop-1', 2, 'dispensary', NOW() - INTERVAL '1 day', '[{"type": "quantity_change", "productId": "prod-sun-2", "productName": "GG4", "newValue": 8, "previousValue": 10}]');

-- Seed VMI Version Items
-- Version 1
INSERT INTO "vmi_version_items" ("version_id", "product_id", "quantity", "price_at_time_of_proposal", "product_snapshot") VALUES
((SELECT id FROM vmi_proposal_versions WHERE vmi_order_id='vmi-prop-1' AND version_number=1), 'prod-sun-2', 10, 45.00, '{"name": "GG4", "sku": "SUN-FL-GG4-70"}');
-- Version 2
INSERT INTO "vmi_version_items" ("version_id", "product_id", "quantity", "price_at_time_of_proposal", "product_snapshot") VALUES
((SELECT id FROM vmi_proposal_versions WHERE vmi_order_id='vmi-prop-1' AND version_number=2), 'prod-sun-2', 8, 45.00, '{"name": "GG4", "sku": "SUN-FL-GG4-70"}');

-- Seed Application Settings
INSERT INTO "application_settings" ("key", "value") VALUES
('inventory_threshold_sunshine', '5'),
('inventory_threshold_fairwinds', '5');

-- Seed Category Sort Order
INSERT INTO "category_sort" ("business_unit", "category_name", "sort_order") VALUES
('sunshine', 'Flower', 1),
('sunshine', 'Pre-Rolls', 2),
('sunshine', 'Vape', 3),
('sunshine', 'Edibles', 4),
('sunshine', 'Concentrates', 5),
('fairwinds', 'Tinctures', 1),
('fairwinds', 'Capsules', 2),
('fairwinds', 'Topicals', 3),
('fairwinds', 'Vape', 4),
('fairwinds', 'Pets', 5);

-- Seed Mobile Nav Config
INSERT INTO "mobile_nav_config" ("id", "label", "icon", "is_visible", "display_order") VALUES
('orders-received', 'Orders', 'Inbox', true, 1),
('products', 'Products', 'Package', true, 2),
('dispensaries', 'Dispensaries', 'Store', true, 3),
('users', 'Users', 'Users', true, 4),
('inventory-fwpf', 'FW/PF Sync', 'RefreshCw', false, 5),
('inventory-ss', 'SS Sync', 'RefreshCw', false, 6),
('productTypes', 'Prod. Types', 'Layers', false, 7),
('categorySort', 'Sort Order', 'ListOrdered', false, 8),
('alertBanners', 'Banners', 'Tag', false, 9),
('roles', 'Roles', 'ShieldCheck', false, 10),
('categories', 'Categories', 'Folder', false, 11),
('mobileNav', 'Mobile Nav', 'Smartphone', false, 12);


-- =============================================
--                 PERMISSIONS
-- =============================================
-- Grant all privileges on tables to the application user
GRANT ALL PRIVILEGES ON TABLE roles TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE users TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE user_business_units TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE categories TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE product_types TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE alert_banners TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE products TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE dispensaries TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE orders TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE order_items TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE vmi_orders TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE vmi_proposal_versions TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE vmi_version_items TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE mobile_nav_config TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE notifications TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE application_settings TO erp_admin;
GRANT ALL PRIVILEGES ON TABLE category_sort TO erp_admin;

-- Grant usage on sequences for SERIAL columns
GRANT USAGE, SELECT ON SEQUENCE product_types_id_seq TO erp_admin;
GRANT USAGE, SELECT ON SEQUENCE order_items_id_seq TO erp_admin;
GRANT USAGE, SELECT ON SEQUENCE vmi_proposal_versions_id_seq TO erp_admin;
GRANT USAGE, SELECT ON SEQUENCE vmi_version_items_id_seq TO erp_admin;
GRANT USAGE, SELECT ON SEQUENCE category_sort_id_seq TO erp_admin;
